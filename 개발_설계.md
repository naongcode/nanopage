# 개발 설계 (나노바나나 프로젝트)

본 문서는 "나노바나나" 프로젝트의 구현을 위한 기술적 설계 내용을 담고 있습니다.

## 1. 기술 스택 (Technical Stack)

서비스의 효율적인 개발과 확장성을 고려하여 다음 기술 스택을 제안합니다.

### 1.1. 프론트엔드 (Frontend)
*   **프레임워크:** Next.js (React 기반)
    *   **선정 이유:** SSR(Server-Side Rendering) 및 SSG(Static Site Generation) 지원으로 SEO 최적화 및 초기 로딩 속도 향상, 파일 시스템 기반 라우팅 및 API Routes 지원으로 개발 편의성 증대.
*   **언어:** TypeScript
    *   **선정 이유:** 코드의 안정성 및 유지보수성 향상, 개발 중 타입 오류 방지로 생산성 증대.
*   **스타일링:** Tailwind CSS
    *   **선정 이유:** 유틸리티 우선 CSS 프레임워크로, 빠른 UI 개발 및 일관된 디자인 시스템 구축에 용이.

### 1.2. 백엔드 (Backend)
*   **프레임워크:** Next.js API Routes (또는 필요 시 Python FastAPI)
    *   **선정 이유:** Next.js API Routes는 프론트엔드 프로젝트 내에서 간단한 API를 구현하기에 적합하며, 배포 및 관리가 용이합니다. 추후 복잡한 로직이나 성능이 필요한 경우, Python FastAPI와 같은 별도 백엔드 분리를 고려할 수 있습니다.
*   **언어:** TypeScript (Next.js API Routes 사용 시) 또는 Python (FastAPI 사용 시)
*   **LLM 연동:** openai API
    *   **선정 이유:** 최신 LLM 모델이며, 에이전트의 개발 환경과 연동성이 좋음.

### 1.3. 데이터베이스 (Database)
*   **종류:** Supabase (PostgreSQL 호환)
    *   **선정 이유:**
        *   PostgreSQL 기반으로 데이터의 정합성 및 무결성 유지에 강하며, 확장성과 안정성이 검증됨.
        *   Backend as a Service (BaaS) 형태로 제공되어, 백엔드 개발 및 운영 부담을 줄일 수 있음. (인증, 실시간 DB, 스토리지 등 다양한 기능 제공)
        *   프론트엔드(Next.js)와의 연동이 용이하며, 개발 속도 향상에 기여.

## 2. 화면 설계 (UI/UX Wireframe)

`상세페이지 기획.md`에 명시된 입력 필드와 서비스 흐름을 바탕으로 사용자 인터페이스(UI)의 레이아웃과 구성을 시각적으로 설계합니다.

### 2.1. 입력 페이지
*   **구성:**
    *   제품 기본 정보 입력 섹션 (제품명, 카테고리, 경쟁사 컨셉, 타겟 고객)
    *   마케팅 컨셉 입력 섹션 (핵심 셀링 포인트 3가지, 주요 시각적 컨셉, 톤앤매너/색상, 필수 연출 상황 2가지, 금지 요소 1가지)
    *   입력 필드별 가이드라인 및 예시 텍스트 제공
    *   "시나리오 생성" 버튼

### 2.2. 결과 페이지
*   **구성:**
    *   생성된 15개의 시나리오를 표 형태로 시각화하여 표시
        *   각 시나리오별 No., 이미지 유형, 역할, 구체적 시나리오(프롬프트) 포함
    *   기획안 초안 검토 및 수정 가능한 에디터 영역
    *   "다운로드 (.md/.txt)", "클립보드 복사", "나노바나나에 전달" 버튼

## 3. 데이터 모델링 (Data Modeling)

사용자 입력 데이터 및 생성된 시나리오 결과를 저장하기 위한 데이터베이스 스키마를 설계합니다.

### 3.1. Project 테이블
*   **목적:** 사용자가 생성한 개별 프로젝트 정보를 저장.
*   **필드:**
    *   `id` (PK, UUID 또는 Serial)
    *   `project_name` (제품명)
    *   `category`
    *   `competitor_concept`
    *   `target_customer`
    *   `selling_point_1`
    *   `selling_point_2`
    *   `selling_point_3`
    *   `visual_concept`
    *   `tone_and_manner`
    *   `required_scene_1`
    *   `required_scene_2`
    *   `forbidden_element`
    *   `created_at` (타임스탬프)
    *   `updated_at` (타임스탬프)

### 3.2. Scenario 테이블
*   **목적:** 각 프로젝트에 속한 15개 시나리오 상세 정보를 저장.
*   **필드:**
    *   `id` (PK, UUID 또는 Serial)
    *   `project_id` (FK, Project 테이블 참조)
    *   `scenario_no` (시나리오 번호, 1~15)
    *   `image_type` (메인, 모델, 디테일 등)
    *   `role`
    *   `prompt_text` (AI 생성 초안 프롬프트)
    *   `user_edited_prompt_text` (사용자 수정 프롬프트, NULL 가능)
    *   `created_at` (타임스탬프)
    *   `updated_at` (타임스탬프)

## 4. API 명세 (API Specification)

프론트엔드와 백엔드 간의 데이터 통신을 위한 API 엔드포인트를 정의합니다.

### 4.1. 프로젝트 생성 및 시나리오 요청 (POST /api/projects)
*   **설명:** 사용자 입력 데이터를 기반으로 새 프로젝트를 생성하고, LLM을 통해 시나리오 초안을 생성하여 반환.
*   **요청 (Request Body):** `Project` 테이블 필드와 동일한 JSON 객체
*   **응답 (Response Body):**
    ```json
    {
      "project_id": "uuid-of-newly-created-project",
      "scenarios": [
        {
          "scenario_no": 1,
          "image_type": "메인",
          "role": "대표 이미지",
          "prompt_text": "AI 생성 프롬프트 내용"
        },
        // ... 14개 시나리오 추가
      ]
    }
    ```

### 4.2. 프로젝트 및 시나리오 조회 (GET /api/projects/{project_id})
*   **설명:** 특정 `project_id`에 해당하는 프로젝트 정보와 모든 시나리오를 조회.
*   **요청 (Request Parameters):** `project_id` (UUID)
*   **응답 (Response Body):**
    ```json
    {
      "project": { /* Project 테이블 필드 */ },
      "scenarios": [
        { /* Scenario 테이블 필드 */ },
        // ...
      ]
    }
    ```

### 4.3. 시나리오 수정 (PUT /api/scenarios/{scenario_id})
*   **설명:** 특정 `scenario_id`에 해당하는 시나리오의 `user_edited_prompt_text` 필드를 업데이트.
*   **요청 (Request Parameters):** `scenario_id` (UUID)
*   **요청 (Request Body):**
    ```json
    {
      "user_edited_prompt_text": "사용자가 수정한 새로운 프롬프트 내용"
    }
    ```
*   **응답 (Response Body):** 업데이트된 `Scenario` 객체

### 4.4. 결과물 다운로드/전달
*   **설명:** 최종 기획안을 `.md` 또는 `.txt` 형태로 다운로드하거나, "나노바나나" 측에 전달하기 위한 API (구현 방식은 추후 논의).
*   **엔드포인트:** `GET /api/projects/{project_id}/download?format=md` 또는 `POST /api/projects/{project_id}/deliver`
